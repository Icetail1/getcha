<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>截图示例</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
<style>
.hidden {
    display: none;
}
</style>
</head>
<body>
<iframe id="embeddedFrame" src="https://b23.tv/iH6ZT9N" width="800" height="600"></iframe>

<button id="screenshotButton">截图</button>

<div id="screenshotContainer" class="hidden">
    <h2>截图结果</h2>
    <div id="screenshotPreview"></div>
</div>

<script>
// 获取截图按钮和截图容器
const screenshotButton = document.getElementById('screenshotButton');
const screenshotContainer = document.getElementById('screenshotContainer');
const screenshotPreview = document.getElementById('screenshotPreview');
const embeddedFrame = document.getElementById('embeddedFrame');

// 监听截图按钮点击事件
screenshotButton.addEventListener('click', () => {
    pauseVideo();
    takeScreenshot();
});

// 暂停视频播放
function pauseVideo() {
    const embeddedDocument = embeddedFrame.contentDocument || embeddedFrame.contentWindow.document;
    const videoElement = embeddedDocument.querySelector('video');
    if (videoElement) {
        videoElement.pause();
    }
}

// 定义截图函数
function takeScreenshot() {
    // 使用 html2canvas 截取 iframe 中的内容
    html2canvas(embeddedFrame).then(canvas => {
        // 将截图显示在页面中
        const screenshotImg = document.createElement('img');
        screenshotImg.src = canvas.toDataURL(); // 将 canvas 转换为图片数据URL
        screenshotImg.alt = '截图';
        screenshotPreview.appendChild(screenshotImg);
        screenshotContainer.classList.remove('hidden');
        resumeVideo(); // 截图完成后恢复视频播放
    });
}

// 恢复视频播放
function resumeVideo() {
    const embeddedDocument = embeddedFrame.contentDocument || embeddedFrame.contentWindow.document;
    const videoElement = embeddedDocument.querySelector('video');
    if (videoElement) {
        videoElement.play();
    }
}
</script>
</body>
</html>
